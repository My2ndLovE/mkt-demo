---
import Layout from '../layouts/Layout.astro';
import MenuCard from '../components/MenuCard.astro';
import { mockUserProfile } from '../data/mockBets.js';

const menuItems = [
  {
    title: '幸運',
    subtitle: '投注',
    icon: '<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10" /></svg>',
    href: '/simple',
    gradient: 'from-orange-400 to-orange-500'
  },
  {
    title: '簡單',
    subtitle: '快速',
    icon: '<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25H12" /></svg>',
    modalType: 'betting',
    gradient: 'from-teal-400 to-teal-500'
  },
  {
    title: '查詢',
    subtitle: '搜尋',
    icon: '<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z" /></svg>',
    href: '/query',
    gradient: 'from-blue-400 to-blue-500'
  },
  {
    title: '取消',
    subtitle: '刪除',
    icon: '<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9.75 9.75l4.5 4.5m0-4.5l-4.5 4.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>',
    href: '/cancel',
    gradient: 'from-red-400 to-red-500'
  },
  {
    title: '總額',
    subtitle: '統計',
    icon: '<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 15.75V18m-7.5-6.75h.008v.008H8.25v-.008zm0 2.25h.008v.008H8.25V13.5zm0 2.25h.008v.008H8.25v-.008zm0 2.25h.008v.008H8.25V18zm2.498-6.75h.007v.008h-.007v-.008zm0 2.25h.007v.008h-.007V13.5zm0 2.25h.007v.008h-.007v-.008zm0 2.25h.007v.008h-.007V18zm2.504-6.75h.008v.008h-.008v-.008zm0 2.25h.008v.008h-.008V13.5zm0 2.25h.008v.008h-.008v-.008zm0 2.25h.008v.008h-.008V18zm2.498-6.75h.008v.008h-.008v-.008zm0 2.25h.008v.008h-.008V13.5zM8.25 6h7.5v2.25h-7.5V6zM12 2.25c-1.892 0-3.758.11-5.593.322C5.307 2.7 4.5 3.65 4.5 4.757V19.5a2.25 2.25 0 002.25 2.25h10.5a2.25 2.25 0 002.25-2.25V4.757c0-1.108-.806-2.057-1.907-2.185A48.507 48.507 0 0012 2.25z" /></svg>',
    href: '/total',
    gradient: 'from-green-400 to-green-500'
  },
  {
    title: '中獎',
    subtitle: '得獎',
    icon: '<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M16.5 18.75h-9m9 0a3 3 0 013 3h-15a3 3 0 013-3m9 0v-3.375c0-.621-.503-1.125-1.125-1.125h-.871M7.5 18.75v-3.375c0-.621.504-1.125 1.125-1.125h.872m5.007 0H9.497m5.007 0a7.454 7.454 0 01-.982-3.172M9.497 14.25a7.454 7.454 0 00.981-3.172M5.25 4.236c-.982.143-1.954.317-2.916.52A6.003 6.003 0 007.73 9.728M5.25 4.236V4.5c0 2.108.966 3.99 2.48 5.228M5.25 4.236V2.721C7.456 2.41 9.71 2.25 12 2.25c2.291 0 4.545.16 6.75.47v1.516M7.73 9.728a6.726 6.726 0 002.748 1.35m8.272-6.842V4.5c0 2.108-.966 3.99-2.48 5.228m2.48-5.492a46.32 46.32 0 012.916.52 6.003 6.003 0 01-5.395 4.972m0 0a6.726 6.726 0 01-2.749 1.35m0 0a6.772 6.772 0 01-3.044 0" /></svg>',
    href: '/winnings',
    gradient: 'from-yellow-400 to-amber-500'
  },
  {
    title: '成績',
    subtitle: '開獎',
    icon: '<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 012.25-2.25h13.5A2.25 2.25 0 0121 7.5v11.25m-18 0A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75m-18 0v-7.5A2.25 2.25 0 015.25 9h13.5A2.25 2.25 0 0121 11.25v7.5" /></svg>',
    modalType: 'results',
    gradient: 'from-purple-400 to-purple-500'
  },
  {
    title: '賬目',
    subtitle: '報表',
    icon: '<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z" /></svg>',
    href: '/accounts',
    gradient: 'from-indigo-400 to-indigo-500'
  },
  {
    title: '指南',
    subtitle: '教學',
    icon: '<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25" /></svg>',
    href: '/guide',
    gradient: 'from-pink-400 to-rose-500'
  },
  {
    title: '用戶',
    subtitle: '設定',
    icon: '<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z" /></svg>',
    href: '/profile',
    gradient: 'from-cyan-400 to-cyan-500'
  },
  {
    title: '報價',
    subtitle: '詳情',
    icon: '<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z" /></svg>',
    href: '/quotation',
    gradient: 'from-slate-400 to-slate-500'
  },
];
---

<Layout title="彩票投注系統" showHeader={false}>
  <div class="min-h-screen bg-gradient-primary bg-wave-pattern p-4"
       x-data="{
         showBettingModal: false,
         showResultsModal: false
       }">
    <!-- User Info Card -->
    <div class="card mb-6 animate-slide-down">
      <div class="flex items-center justify-between">
        <div>
          <h2 class="text-2xl font-bold text-gray-900">歡迎 {mockUserProfile.name}</h2>
          <p class="text-sm text-gray-500 mt-1">代理編號: {mockUserProfile.agentId}</p>
        </div>
        <div class="text-right">
          <p class="text-sm text-gray-500">每週限額</p>
          <p class="text-2xl font-bold text-primary-600">{mockUserProfile.currency} {mockUserProfile.weeklyLimit.toLocaleString()}</p>
        </div>
      </div>

      <div class="mt-4 pt-4 border-t border-gray-200">
        <div class="flex justify-between text-sm">
          <span class="text-gray-600">已使用</span>
          <span class="font-semibold text-red-600">{mockUserProfile.currency} {mockUserProfile.usedAmount.toLocaleString()}</span>
        </div>
        <div class="flex justify-between text-sm mt-2">
          <span class="text-gray-600">剩餘額度</span>
          <span class="font-semibold text-green-600">{mockUserProfile.currency} {mockUserProfile.remainingAmount.toLocaleString()}</span>
        </div>

        <!-- Progress Bar -->
        <div class="mt-3 bg-gray-200 rounded-full h-2 overflow-hidden">
          <div
            class="bg-gradient-to-r from-primary-500 to-primary-600 h-full transition-all duration-500"
            style={`width: ${(mockUserProfile.usedAmount / mockUserProfile.weeklyLimit) * 100}%`}
          ></div>
        </div>
      </div>
    </div>

    <!-- Betting Mode Selection Modal -->
    <div x-show="showBettingModal"
         @click.self="showBettingModal = false"
         class="fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4"
         x-transition:enter="transition ease-out duration-300"
         x-transition:enter-start="opacity-0"
         x-transition:enter-end="opacity-100"
         x-transition:leave="transition ease-in duration-200"
         x-transition:leave-start="opacity-100"
         x-transition:leave-end="opacity-0"
         style="display: none;">
      <div class="bg-white rounded-3xl p-6 w-full max-w-sm animate-scale-in shadow-2xl"
           @click.stop>
        <h3 class="font-bold text-2xl mb-6 text-center text-gray-900">選擇輸入模式</h3>
        <div class="space-y-3">
          <a href="/betting"
             class="block w-full p-5 text-center border-2 border-orange-200 bg-gradient-to-r from-orange-50 to-orange-100 rounded-2xl hover:border-orange-400 active:scale-95 transition-all shadow-md">
            <span class="font-bold text-lg text-orange-900">簡單輸入</span>
            <p class="text-sm text-orange-700 mt-1">完整表格輸入</p>
          </a>
          <a href="/simple"
             class="block w-full p-5 text-center border-2 border-blue-200 bg-gradient-to-r from-blue-50 to-blue-100 rounded-2xl hover:border-blue-400 active:scale-95 transition-all shadow-md">
            <span class="font-bold text-lg text-blue-900">自由輸入</span>
            <p class="text-sm text-blue-700 mt-1">文字快速輸入</p>
          </a>
        </div>
      </div>
    </div>

    <!-- Results Mode Selection Modal -->
    <div x-show="showResultsModal"
         @click.self="showResultsModal = false"
         class="fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4"
         x-transition:enter="transition ease-out duration-300"
         x-transition:enter-start="opacity-0"
         x-transition:enter-end="opacity-100"
         x-transition:leave="transition ease-in duration-200"
         x-transition:leave-start="opacity-100"
         x-transition:leave-end="opacity-0"
         style="display: none;">
      <div class="bg-white rounded-3xl p-6 w-full max-w-sm animate-scale-in shadow-2xl"
           @click.stop>
        <h3 class="font-bold text-2xl mb-6 text-center text-gray-900">查看開獎</h3>
        <div class="space-y-3">
          <a href="/results"
             class="block w-full p-5 text-center border-2 border-purple-200 bg-gradient-to-r from-purple-50 to-purple-100 rounded-2xl hover:border-purple-400 active:scale-95 transition-all shadow-md">
            <span class="font-bold text-lg text-purple-900">開獎日曆</span>
            <p class="text-sm text-purple-700 mt-1">查看歷史開獎</p>
          </a>
          <a href="/winnings"
             class="block w-full p-5 text-center border-2 border-green-200 bg-gradient-to-r from-green-50 to-green-100 rounded-2xl hover:border-green-400 active:scale-95 transition-all shadow-md">
            <span class="font-bold text-lg text-green-900">我的中獎</span>
            <p class="text-sm text-green-700 mt-1">查看中獎記錄</p>
          </a>
        </div>
      </div>
    </div>

    <!-- Modern Menu Grid -->
    <div class="grid grid-cols-2 gap-3 mb-4">
      {menuItems.map((item, index) => (
        item.modalType ? (
          <button
            @click={item.modalType === 'betting' ? 'showBettingModal = true' : 'showResultsModal = true'}
            class={`relative overflow-hidden rounded-2xl p-6 shadow-xl active:scale-95 transition-all bg-gradient-to-br ${item.gradient} animate-scale-in`}
            style={`animation-delay: ${index * 0.05}s; min-height: 140px`}>
            <div class="relative z-10 flex flex-col items-center justify-center h-full text-center">
              <div class="w-16 h-16 mb-3 text-white flex items-center justify-center" set:html={item.icon} />
              <div>
                <h3 class="text-xl font-bold text-white mb-0.5">{item.title}</h3>
                <p class="text-sm text-white/90">{item.subtitle}</p>
              </div>
            </div>
            <div class="absolute top-0 right-0 w-24 h-24 bg-white/10 rounded-full blur-2xl -translate-y-1/2 translate-x-1/2"></div>
            <div class="absolute bottom-0 left-0 w-20 h-20 bg-white/10 rounded-full blur-xl translate-y-1/2 -translate-x-1/2"></div>
          </button>
        ) : (
          <a
            href={item.href}
            class={`relative overflow-hidden rounded-2xl p-6 shadow-xl active:scale-95 transition-all bg-gradient-to-br ${item.gradient} animate-scale-in`}
            style={`animation-delay: ${index * 0.05}s; min-height: 140px`}>
            <div class="relative z-10 flex flex-col items-center justify-center h-full text-center">
              <div class="w-16 h-16 mb-3 text-white flex items-center justify-center" set:html={item.icon} />
              <div>
                <h3 class="text-xl font-bold text-white mb-0.5">{item.title}</h3>
                <p class="text-sm text-white/90">{item.subtitle}</p>
              </div>
            </div>
            <div class="absolute top-0 right-0 w-24 h-24 bg-white/10 rounded-full blur-2xl -translate-y-1/2 translate-x-1/2"></div>
            <div class="absolute bottom-0 left-0 w-20 h-20 bg-white/10 rounded-full blur-xl translate-y-1/2 -translate-x-1/2"></div>
          </a>
        )
      ))}
    </div>

    <!-- Footer Info -->
    <div class="mt-8 text-center">
      <p class="text-white/80 text-sm">上線代理: {mockUserProfile.uplineAgent}</p>
      <p class="text-white/60 text-xs mt-2">佣金比例: {mockUserProfile.commissionRate}%</p>
    </div>
  </div>
</Layout>
